# ✅ 部署检查清单

**使用此清单确保部署顺利进行**

---

## 📋 部署前检查

### 代码准备
- [ ] 所有功能在本地测试通过
- [ ] 运行 `npm run build` 无错误
- [ ] 运行 `.\scripts\pre-deploy-check.ps1` 通过
- [ ] Git 工作区干净（无未提交的改动）
- [ ] 代码已推送到 GitHub

### 环境配置
- [ ] `frontend/.env` 已配置所有必需变量
- [ ] `backend/.env` 已配置所有必需变量
- [ ] 合约地址格式正确（0x + 40 位十六进制）
- [ ] RPC URL 可访问
- [ ] 数据库连接字符串正确

### 账号准备
- [ ] Vercel 账号已注册
- [ ] Railway/Render 账号已注册
- [ ] GitHub 仓库已创建
- [ ] 部署账户有足够的测试 ETH

---

## 🚀 部署过程检查

### 前端部署（Vercel）
- [ ] 项目已导入到 Vercel
- [ ] Root Directory 设置为 `frontend`
- [ ] Framework 选择为 `Vite`
- [ ] Build Command: `npm run build`
- [ ] Output Directory: `dist`
- [ ] 所有环境变量已添加
- [ ] 首次部署成功
- [ ] 获得部署 URL

### 后端部署（Railway）
- [ ] 项目已创建
- [ ] Root Directory 设置为 `backend`
- [ ] PostgreSQL 数据库已添加
- [ ] 所有环境变量已配置
- [ ] `DATABASE_URL` 已自动填充
- [ ] 运行 `npx prisma migrate deploy`
- [ ] 运行 `npx prisma generate`
- [ ] 服务启动成功
- [ ] 获得后端 URL

### 环境变量同步
- [ ] 前端 `VITE_BACKEND_BASE_URL` = 后端 URL
- [ ] 后端 `CORS_ORIGIN` = 前端 URL
- [ ] 合约地址在前后端一致
- [ ] Chain ID 在前后端一致

---

## 🧪 部署后验证

### 后端健康检查
- [ ] 访问 `/healthz` 端点返回 200
- [ ] 数据库连接状态为 "ok"
- [ ] RPC 连接状态为 "ok"
- [ ] 无错误日志

### 前端功能测试
- [ ] 页面正常加载（无白屏）
- [ ] 无控制台错误
- [ ] 钱包连接功能正常
- [ ] 网络切换提示正常
- [ ] 静态资源加载正常

### 核心功能测试
- [ ] 注册流程完整
  - [ ] 表单验证正常
  - [ ] 交易确认正常
  - [ ] 获得 100 EOCHO
  - [ ] Profile 数据正确
  
- [ ] 发布任务流程
  - [ ] 表单填写正常
  - [ ] 联系方式预览正确
  - [ ] 交易确认正常
  - [ ] 任务出现在广场
  
- [ ] Profile 页面
  - [ ] Stats 显示正确（无需点击标签）
  - [ ] 任务历史加载正常
  - [ ] 标签切换正常
  - [ ] 余额显示正确

### 性能检查
- [ ] 首屏加载时间 < 3 秒
- [ ] 页面切换流畅
- [ ] 无明显卡顿
- [ ] 图片/资源加载正常

---

## 🔒 安全检查

### 环境变量安全
- [ ] 私钥未暴露在代码中
- [ ] `.env` 文件在 `.gitignore` 中
- [ ] 生产环境使用独立的密钥
- [ ] API 密钥未提交到 Git

### CORS 配置
- [ ] 后端 CORS 只允许前端域名
- [ ] 不使用 `*` 通配符
- [ ] 生产环境配置正确

### 合约安全
- [ ] 合约地址已验证
- [ ] 合约在 Etherscan 上可见
- [ ] 合约权限配置正确

---

## 📊 监控设置

### 日志监控
- [ ] Vercel 部署日志可访问
- [ ] Railway 应用日志可访问
- [ ] 错误日志有告警机制

### 性能监控
- [ ] Vercel Analytics 已启用
- [ ] 后端响应时间监控
- [ ] 数据库查询性能监控

### 用户反馈
- [ ] 反馈渠道已设置
- [ ] 错误报告机制就绪
- [ ] 用户支持文档准备

---

## 📝 文档准备

### 用户文档
- [ ] 快速开始指南
- [ ] 功能使用说明
- [ ] 常见问题解答
- [ ] 故障排查指南

### 开发文档
- [ ] 部署流程文档
- [ ] 更新流程文档
- [ ] API 文档
- [ ] 架构说明

---

## 🎯 Beta 测试准备

### 测试用户准备
- [ ] 测试用户列表（5-20 人）
- [ ] 测试账户准备（有测试 ETH）
- [ ] 测试任务场景设计
- [ ] 反馈收集表单

### 支持准备
- [ ] 技术支持联系方式
- [ ] 响应时间承诺
- [ ] 问题跟踪系统
- [ ] 紧急修复流程

---

## 🔄 回滚准备

### 回滚计划
- [ ] 上一个稳定版本已标记
- [ ] 回滚步骤已文档化
- [ ] 数据库备份已创建
- [ ] 回滚测试已验证

### 紧急联系
- [ ] 技术负责人联系方式
- [ ] 云平台支持联系方式
- [ ] 团队成员联系列表

---

## 📅 部署时间规划

### 推荐部署时间
- [ ] 工作日（非周五）
- [ ] 白天时间（便于监控）
- [ ] 避开用户高峰期
- [ ] 预留 2-4 小时处理问题

### 部署后监控
- [ ] 部署后 1 小时：密切监控
- [ ] 部署后 24 小时：定期检查
- [ ] 部署后 1 周：持续观察

---

## ✅ 最终确认

### 部署决策
- [ ] 所有检查项已完成
- [ ] 团队成员已知晓
- [ ] 用户已通知（如需要）
- [ ] 准备好处理问题

### 部署执行
- [ ] 执行部署命令
- [ ] 验证部署成功
- [ ] 通知相关人员
- [ ] 开始监控

---

## 📞 紧急联系

**如果遇到严重问题：**

1. 立即停止部署
2. 回滚到上一个版本
3. 联系技术负责人
4. 记录问题详情
5. 安排修复计划

---

## 🎉 部署成功！

- [ ] 所有检查通过
- [ ] 功能正常运行
- [ ] 用户可以访问
- [ ] 监控系统运行
- [ ] 团队已通知

**恭喜！部署完成！** 🚀

---

**使用建议**：
- 打印此清单或保存为书签
- 每次部署前完整检查一遍
- 记录遇到的问题和解决方案
- 持续优化检查流程
